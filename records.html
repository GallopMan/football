<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Í∏∞Î°ùÏã§</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-green: #2d5016;
            --field-green: #5ba83f;
            --light-green: #7bc34a;
            --white: #ffffff;
            --gray-light: #f5f5f5;
            --gray-border: #ddd;
            --accent: #ff6b6b;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        /* Ìó§Îçî */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background: var(--white);
            padding: 20px 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: var(--primary-green);
            font-size: 28px;
        }

        .header-buttons {
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 14px;
        }

        .btn-back {
            background: var(--gray-border);
            color: var(--primary-green);
        }

        .btn-back:hover {
            background: #ccc;
        }

        .btn-edit {
            background: var(--field-green);
            color: white;
        }

        .btn-edit:hover {
            background: var(--light-green);
        }

        /* ÏãúÏ¶å ÏÑ†ÌÉù ÏÑπÏÖò */
        .season-section {
            background: var(--white);
            padding: 25px 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .season-section h3 {
            color: var(--primary-green);
            margin-bottom: 20px;
            font-size: 16px;
            font-weight: 600;
        }

        .season-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .season-input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .season-input-group label {
            color: var(--primary-green);
            font-weight: 600;
            font-size: 13px;
        }

        .season-input-group input {
            padding: 10px;
            border: 2px solid var(--gray-border);
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .season-input-group input:focus {
            outline: none;
            border-color: var(--field-green);
        }

        .season-buttons {
            display: flex;
            gap: 12px;
        }

        .btn-create-season {
            flex: 1;
            padding: 12px;
            background: var(--field-green);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-create-season:hover {
            background: var(--light-green);
        }

        /* Ï†ÄÏû•Îêú ÏãúÏ¶å Î™©Î°ù */
        .seasons-list {
            margin-top: 20px;
        }

        .seasons-list h4 {
            color: var(--primary-green);
            margin-bottom: 15px;
            font-size: 14px;
            font-weight: 600;
        }

        .season-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: var(--gray-light);
            border-radius: 8px;
            border-left: 4px solid var(--field-green);
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .season-item:hover {
            background: #e8f5e9;
            transform: translateX(4px);
        }

        .season-item.active {
            background: #e8f5e9;
            border-left-color: var(--light-green);
            box-shadow: 0 2px 8px rgba(91, 168, 63, 0.2);
        }

        .season-item-info {
            flex: 1;
        }

        .season-item-name {
            color: var(--primary-green);
            font-weight: 700;
            font-size: 15px;
            margin-bottom: 4px;
        }

        .season-item-date {
            color: #999;
            font-size: 12px;
        }

        .season-item-actions {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 12px;
            transition: all 0.3s;
        }

        .btn-delete {
            background: var(--accent);
            color: white;
        }

        .btn-delete:hover {
            background: #ff5252;
        }

        /* ÌåÄ Ï†ïÎ≥¥ */
        .team-selector {
            background: var(--white);
            padding: 20px 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .team-info-display {
            background: var(--gray-light);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--field-green);
        }

        .team-info-display h2 {
            color: var(--primary-green);
            font-size: 20px;
            margin-bottom: 10px;
        }

        .team-info-display p {
            color: #555;
            font-size: 14px;
            margin: 5px 0;
        }

        /* ÏÑ†Ïàò Î™©Î°ù */
        .players-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .player-card {
            background: var(--white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .player-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
        }

        .player-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--gray-light);
        }

        .player-number {
            background: var(--field-green);
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            margin-right: 15px;
        }

        .player-name {
            flex: 1;
            color: var(--primary-green);
            font-weight: 700;
            font-size: 18px;
        }

        .player-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .stat-item {
            background: var(--gray-light);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .stat-item.edit-mode {
            border: 2px solid var(--field-green);
            background: #f0f8ff;
        }

        .stat-label {
            color: #999;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .stat-value {
            color: var(--primary-green);
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-controls {
            display: none;
            justify-content: center;
            gap: 8px;
        }

        .stat-item.edit-mode .stat-controls {
            display: flex;
        }

        .stat-btn {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: 50%;
            background: var(--field-green);
            color: white;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.2s;
        }

        .stat-btn:hover {
            background: var(--light-green);
            transform: scale(1.1);
        }

        .stat-btn.minus {
            background: var(--accent);
        }

        .stat-btn.minus:hover {
            background: #ff5252;
        }


        /* ÌïòÎã® Î≤ÑÌäº */
        .footer-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 40px;
        }

        .btn-large {
            padding: 14px 40px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-save-large {
            background: var(--field-green);
            color: white;
        }

        .btn-save-large:hover {
            background: var(--light-green);
            box-shadow: 0 4px 12px rgba(123, 195, 74, 0.3);
        }

        .btn-cancel-large {
            background: var(--gray-border);
            color: var(--primary-green);
        }

        .btn-cancel-large:hover {
            background: #ccc;
        }

        /* Í≤ΩÍ∏∞ Ï†ÑÏ†Å ÏÑπÏÖò */
        .match-records-section {
            background: var(--white);
            padding: 25px 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .match-records-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .match-records-header h3 {
            color: var(--primary-green);
            font-size: 18px;
            font-weight: 600;
        }

        .btn-add-match {
            padding: 8px 16px;
            background: var(--field-green);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn-add-match:hover {
            background: var(--light-green);
        }

        .match-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .match-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid;
            transition: all 0.3s;
        }

        .match-item.win {
            background: #e8f5e9;
            border-left-color: #4caf50;
        }

        .match-item.loss {
            background: #ffebee;
            border-left-color: #f44336;
        }

        .match-item.draw {
            background: #f5f5f5;
            border-left-color: #9e9e9e;
        }

        .match-item:hover {
            transform: translateX(4px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .match-team-logo {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #ddd;
            margin-right: 10px;
        }

        .match-team-name {
            flex: 1;
            font-weight: 600;
            color: var(--primary-green);
            font-size: 14px;
        }

        .match-score {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary-green);
            margin: 0 15px;
        }

        .match-opponent {
            flex: 1;
            text-align: right;
            font-weight: 600;
            color: #666;
            font-size: 14px;
        }

        .match-date {
            font-size: 12px;
            color: #999;
            margin-left: 15px;
        }

        .show-more-btn {
            width: 100%;
            padding: 12px;
            margin-top: 10px;
            background: var(--gray-light);
            border: 2px solid var(--gray-border);
            border-radius: 6px;
            color: var(--primary-green);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .show-more-btn:hover {
            background: #e8f5e9;
            border-color: var(--field-green);
        }

        /* Í≤ΩÍ∏∞ Ï∂îÍ∞Ä Î™®Îã¨ */
        .match-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .match-modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .match-modal-header {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-green);
            margin-bottom: 25px;
            text-align: center;
        }

        .match-form-group {
            margin-bottom: 20px;
        }

        .match-form-label {
            display: block;
            font-weight: 600;
            color: var(--primary-green);
            margin-bottom: 8px;
            font-size: 14px;
        }

        .match-form-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .match-form-input:focus {
            outline: none;
            border-color: var(--field-green);
        }

        .score-control {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
        }

        .score-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            background: var(--field-green);
            color: white;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .score-btn:hover {
            background: var(--light-green);
            transform: scale(1.1);
        }

        .score-btn.minus {
            background: var(--accent);
        }

        .score-btn.minus:hover {
            background: #ff5252;
        }

        .score-display {
            font-size: 48px;
            font-weight: bold;
            color: var(--primary-green);
            min-width: 80px;
            text-align: center;
        }

        .match-modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 30px;
        }

        .match-modal-buttons button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-save-match {
            background: var(--field-green);
            color: white;
        }

        .btn-save-match:hover {
            background: var(--light-green);
        }

        .btn-cancel-match {
            background: #ddd;
            color: #333;
        }

        .btn-cancel-match:hover {
            background: #ccc;
        }

        /* Î©îÏãúÏßÄ */
        .success-message {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--field-green);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            animation: slideIn 0.3s ease-out;
            z-index: 2000;
        }

        .no-team-message {
            text-align: center;
            padding: 60px 20px;
            color: #999;
            font-size: 16px;
            font-style: italic;
        }

        .no-team-message a {
            display: inline-block;
            margin-top: 20px;
            padding: 12px 30px;
            background: var(--field-green);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-style: normal;
            font-weight: 600;
            transition: all 0.3s;
        }

        .no-team-message a:hover {
            background: var(--light-green);
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .player-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .header {
                flex-direction: column;
                gap: 15px;
            }

            .header-buttons {
                width: 100%;
            }

            .header-buttons button {
                flex: 1;
            }

            .season-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ìó§Îçî -->
        <div class="header">
            <h1>üìä Í∏∞Î°ùÏã§</h1>
            <div class="header-buttons">
                <button class="btn btn-back" onclick="goBack()">‚Üê Îí§Î°úÍ∞ÄÍ∏∞</button>
                <button class="btn btn-edit" id="editBtn" onclick="toggleEditMode()">ÏàòÏ†ï</button>
            </div>
        </div>

        <!-- ÏãúÏ¶å ÏÑ†ÌÉù ÏÑπÏÖò -->
        <div class="season-section">
            <h3>üìÖ ÏãúÏ¶å Í¥ÄÎ¶¨</h3>
            
            <div class="season-grid">
                <div class="season-input-group">
                    <label for="seasonName">ÏãúÏ¶å Ïù¥Î¶Ñ</label>
                    <input type="text" id="seasonName" placeholder="Ïòà: 2024 Î¥Ñ ÏãúÏ¶å">
                </div>
                <div class="season-input-group">
                    <label for="startDate">ÏãúÏûëÏùº</label>
                    <input type="date" id="startDate">
                </div>
                <div class="season-input-group">
                    <label for="endDate">Ï¢ÖÎ£åÏùº</label>
                    <input type="date" id="endDate">
                </div>
            </div>

            <div class="season-buttons">
                <button class="btn-create-season" onclick="createSeason()">ÏãúÏ¶å ÏÉùÏÑ±</button>
            </div>

            <!-- Ï†ÄÏû•Îêú ÏãúÏ¶å Î™©Î°ù -->
            <div class="seasons-list" id="seasonsList">
                <!-- Ï†ÄÏû•Îêú ÏãúÏ¶åÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
            </div>
        </div>

        <!-- ÌåÄ Ï†ïÎ≥¥ -->
        <div class="team-selector" id="teamSelector">
            <!-- ÌåÄ Ï†ïÎ≥¥Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
        </div>

        <!-- Í≤ΩÍ∏∞ Ï†ÑÏ†Å -->
        <div class="match-records-section" id="matchRecordsSection">
            <div class="match-records-header">
                <h3>‚öΩ Í≤ΩÍ∏∞ Ï†ÑÏ†Å</h3>
                <button class="btn-add-match" onclick="openMatchModal()">+ Í≤ΩÍ∏∞ Ï∂îÍ∞Ä</button>
            </div>
            <div class="match-list" id="matchList">
                <!-- Í≤ΩÍ∏∞ Ï†ÑÏ†ÅÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
            </div>
            <button class="show-more-btn" id="showMoreBtn" onclick="toggleShowMore()" style="display: none;">
                ÎçîÎ≥¥Í∏∞
            </button>
        </div>

        <!-- ÏÑ†Ïàò Í∏∞Î°ù -->
        <div class="players-container" id="playersContainer">
            <!-- ÏÑ†ÏàòÎì§Ïùò Í∏∞Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
        </div>

        <!-- ÌïòÎã® Î≤ÑÌäº (Ìé∏Ïßë Î™®Îìú) -->
        <div class="footer-buttons" id="footerButtons" style="display: none;">
            <button class="btn-large btn-save-large" onclick="saveRecords()">Ï†ÄÏû•</button>
            <button class="btn-large btn-cancel-large" onclick="cancelEdit()">Ï∑®ÏÜå</button>
        </div>
    </div>

    <div class="success-message" id="successMessage">Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§! ‚úì</div>

    <!-- Í≤ΩÍ∏∞ Ï∂îÍ∞Ä Î™®Îã¨ -->
    <div id="matchModal" class="match-modal">
        <div class="match-modal-content">
            <div class="match-modal-header"> Í≤ΩÍ∏∞ Í≤∞Í≥º ÏûÖÎ†•</div>

            <div class="match-form-group">
                <label class="match-form-label">Í≤ΩÍ∏∞ ÎÇ†Ïßú</label>
                <input type="date" id="matchDate" class="match-form-input">
            </div>

            <div class="match-form-group">
                <label class="match-form-label">ÏÉÅÎåÄ ÌåÄ Ïù¥Î¶Ñ</label>
                <input type="text" id="opponentName" class="match-form-input" placeholder="ÏÉÅÎåÄ ÌåÄ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
            </div>

            <div class="match-form-group">
                <label class="match-form-label">Ïö∞Î¶¨ ÌåÄ ÎìùÏ†ê</label>
                <div class="score-control">
                    <button class="score-btn minus" onclick="adjustScore('my', -1)">‚àí</button>
                    <div class="score-display" id="myScore">0</div>
                    <button class="score-btn" onclick="adjustScore('my', 1)">+</button>
                </div>
            </div>

            <div class="match-form-group">
                <label class="match-form-label">ÏÉÅÎåÄ ÌåÄ ÎìùÏ†ê</label>
                <div class="score-control">
                    <button class="score-btn minus" onclick="adjustScore('opponent', -1)">‚àí</button>
                    <div class="score-display" id="opponentScore">0</div>
                    <button class="score-btn" onclick="adjustScore('opponent', 1)">+</button>
                </div>
            </div>

            <div class="match-modal-buttons">
                <button class="btn-save-match" onclick="saveMatch()">Ï†ÄÏû•</button>
                <button class="btn-cancel-match" onclick="closeMatchModal()">Ï∑®ÏÜå</button>
            </div>
        </div>
    </div>

    <script>
        let currentTeam = null;
        let isEditMode = false;
        let currentSeasonId = null;
        let seasons = []; // { id, name, startDate, endDate, records: {}, matches: [] }
        let tempRecords = {};
        let myScore = 0;
        let opponentScore = 0;
        let showAllMatches = false;

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
        window.addEventListener('load', function() {
            loadTeamData();
            loadSeasons();
            renderUI();
        });

        // ÌåÄ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        function loadTeamData() {
            const savedData = localStorage.getItem('teamSetup');
            
            if (!savedData) {
                document.getElementById('teamSelector').innerHTML = `
                    <p class="no-team-message">
                        Ï†ÄÏû•Îêú ÌåÄÏù¥ ÏóÜÏäµÎãàÎã§.<br>
                        Î®ºÏ†Ä ÌåÄÏùÑ Íµ¨ÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî.<br>
                        <a href="index.html">‚Üê Î©îÏù∏ÏúºÎ°ú</a>
                    </p>
                `;
                document.getElementById('playersContainer').innerHTML = '';
                return;
            }

            currentTeam = JSON.parse(savedData);
        }

        // ÏãúÏ¶å Î°úÎìú
        function loadSeasons() {
            const saved = localStorage.getItem('allSeasons');
            if (saved) {
                seasons = JSON.parse(saved);
            }
        }

        // ÏãúÏ¶å ÏÉùÏÑ±
        function createSeason() {
            const name = document.getElementById('seasonName').value.trim();
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;

            if (!name) {
                alert('ÏãúÏ¶å Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            if (!startDate || !endDate) {
                alert('ÏãúÏûëÏùºÍ≥º Ï¢ÖÎ£åÏùºÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            if (startDate > endDate) {
                alert('ÏãúÏûëÏùºÏù¥ Ï¢ÖÎ£åÏùºÎ≥¥Îã§ ÌÅ¥ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }

            const seasonId = Date.now().toString();
            const records = {};

            // Í∞Å ÏÑ†ÏàòÎ≥Ñ Í∏∞Î°ù Ï¥àÍ∏∞Ìôî
            currentTeam.players.forEach(player => {
                records[player.id] = {
                    name: player.name,
                    number: player.number,
                    matches: 0,
                    goals: 0,
                    assists: 0,
                    mom: 0
                };
            });

            const newSeason = {
                id: seasonId,
                name: name,
                startDate: startDate,
                endDate: endDate,
                records: records,
                matches: []
            };

            seasons.push(newSeason);
            localStorage.setItem('allSeasons', JSON.stringify(seasons));

            // ÏûÖÎ†•Ï∞Ω Ï¥àÍ∏∞Ìôî
            document.getElementById('seasonName').value = '';
            document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = '';

            // ÏÉàÎ°ú ÏÉùÏÑ±Îêú ÏãúÏ¶å ÏÑ†ÌÉù
            selectSeason(seasonId);
            renderSeasonsList();
        }

        // ÏãúÏ¶å ÏÑ†ÌÉù
        function selectSeason(seasonId) {
            currentSeasonId = seasonId;
            const season = seasons.find(s => s.id === seasonId);
            
            if (season) {
                tempRecords = JSON.parse(JSON.stringify(season.records));
                renderUI();
            }
        }

        // ÏãúÏ¶å ÏÇ≠Ï†ú
        function deleteSeason(seasonId, event) {
            event.stopPropagation();
            
            if (confirm('Ïù¥ ÏãúÏ¶åÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                seasons = seasons.filter(s => s.id !== seasonId);
                localStorage.setItem('allSeasons', JSON.stringify(seasons));

                if (currentSeasonId === seasonId) {
                    currentSeasonId = null;
                    tempRecords = {};
                }

                renderSeasonsList();
                renderUI();
            }
        }

        // ÏãúÏ¶å Î™©Î°ù Î†åÎçîÎßÅ
        function renderSeasonsList() {
            const seasonsList = document.getElementById('seasonsList');

            if (seasons.length === 0) {
                seasonsList.innerHTML = '<p style="color: #999; text-align: center; padding: 20px;">ÏÉùÏÑ±Îêú ÏãúÏ¶åÏù¥ ÏóÜÏäµÎãàÎã§.</p>';
                return;
            }

            let html = '<h4>üìã Ï†ÄÏû•Îêú ÏãúÏ¶å</h4>';

            seasons.forEach(season => {
                const isActive = currentSeasonId === season.id;
                const startDate = new Date(season.startDate).toLocaleDateString('ko-KR');
                const endDate = new Date(season.endDate).toLocaleDateString('ko-KR');

                html += `
                    <div class="season-item ${isActive ? 'active' : ''}" onclick="selectSeason('${season.id}')">
                        <div class="season-item-info">
                            <div class="season-item-name">${season.name}</div>
                            <div class="season-item-date">${startDate} ~ ${endDate}</div>
                        </div>
                        <div class="season-item-actions">
                            <button class="btn-small btn-delete" onclick="deleteSeason('${season.id}', event)">ÏÇ≠Ï†ú</button>
                        </div>
                    </div>
                `;
            });

            seasonsList.innerHTML = html;
        }

        // UI Î†åÎçîÎßÅ
        function renderUI() {
            if (!currentTeam) return;

            renderTeamInfo();
            renderMatchRecords();
            renderPlayerRecords();
            renderSeasonsList();
        }

        // ÌåÄ Ï†ïÎ≥¥ Î†åÎçîÎßÅ
        function renderTeamInfo() {
            const onFieldPlayers = currentTeam.players.filter(p => p.onField);
            const subPlayers = currentTeam.players.filter(p => !p.onField);

            document.getElementById('teamSelector').innerHTML = `
                <h3>ÌåÄ Ï†ïÎ≥¥</h3>
                <div class="team-info-display">
                    <h2> ${currentTeam.teamName}</h2>
                    <p>ÌïÑÎìú ÏÑ†Ïàò: <strong>${onFieldPlayers.length}Î™Ö</strong></p>
                    <p>ÍµêÎåÄ ÏÑ†Ïàò: <strong>${subPlayers.length}Î™Ö</strong></p>
                    <p>Ï†ÑÏ≤¥: <strong>${currentTeam.players.length}Î™Ö</strong></p>
                </div>
            `;
        }

        // ÏÑ†Ïàò Í∏∞Î°ù Î†åÎçîÎßÅ
        function renderPlayerRecords() {
            if (!currentSeasonId || Object.keys(tempRecords).length === 0) {
                document.getElementById('playersContainer').innerHTML = `
                    <p style="text-align: center; padding: 40px 20px; color: #999;">
                        ÏãúÏ¶åÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.
                    </p>
                `;
                return;
            }

            let html = '';

            const fieldPlayers = currentTeam.players.filter(p => p.onField);
            const benchPlayers = currentTeam.players.filter(p => !p.onField);
            const allPlayers = [...fieldPlayers, ...benchPlayers];

            allPlayers.forEach(player => {
                const record = tempRecords[player.id] || {
                    matches: 0,
                    goals: 0,
                    assists: 0,
                    mom: 0
                };

                html += `
                    <div class="player-card">
                        <div class="player-header">
                            <div class="player-number">${player.number}</div>
                            <div class="player-name">${player.name}</div>
                        </div>

                        <div class="player-stats">
                            <!-- Í≤ΩÍ∏∞Ïàò -->
                            <div class="stat-item" id="stat-matches-${player.id}">
                                <div class="stat-label">Í≤ΩÍ∏∞Ïàò</div>
                                <div class="stat-value" id="value-matches-${player.id}">${record.matches}</div>
                                <div class="stat-controls">
                                    <button class="stat-btn minus" onclick="decrementStat(${player.id}, 'matches')">‚àí</button>
                                    <button class="stat-btn" onclick="incrementStat(${player.id}, 'matches')">+</button>
                                </div>
                            </div>

                            <!-- ÎìùÏ†ê -->
                            <div class="stat-item" id="stat-goals-${player.id}">
                                <div class="stat-label">ÎìùÏ†ê</div>
                                <div class="stat-value" id="value-goals-${player.id}">${record.goals}</div>
                                <div class="stat-controls">
                                    <button class="stat-btn minus" onclick="decrementStat(${player.id}, 'goals')">‚àí</button>
                                    <button class="stat-btn" onclick="incrementStat(${player.id}, 'goals')">+</button>
                                </div>
                            </div>

                            <!-- ÎèÑÏõÄ -->
                            <div class="stat-item" id="stat-assists-${player.id}">
                                <div class="stat-label">ÎèÑÏõÄ</div>
                                <div class="stat-value" id="value-assists-${player.id}">${record.assists}</div>
                                <div class="stat-controls">
                                    <button class="stat-btn minus" onclick="decrementStat(${player.id}, 'assists')">‚àí</button>
                                    <button class="stat-btn" onclick="incrementStat(${player.id}, 'assists')">+</button>
                                </div>
                            </div>

                            <!-- MOM -->
                            <div class="stat-item" id="stat-mom-${player.id}">
                                <div class="stat-label">MOM</div>
                                <div class="stat-value" id="value-mom-${player.id}">${record.mom}</div>
                                <div class="stat-controls">
                                    <button class="stat-btn minus" onclick="decrementStat(${player.id}, 'mom')">‚àí</button>
                                    <button class="stat-btn" onclick="incrementStat(${player.id}, 'mom')">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });

            document.getElementById('playersContainer').innerHTML = html;
        }

        // Ïä§ÌÉØ Ï¶ùÍ∞Ä
        function incrementStat(playerId, statType) {
            if (!tempRecords[playerId]) {
                tempRecords[playerId] = { matches: 0, goals: 0, assists: 0, mom: 0 };
            }
            tempRecords[playerId][statType]++;
            updateStatDisplay(playerId, statType);
        }

        // Ïä§ÌÉØ Í∞êÏÜå
        function decrementStat(playerId, statType) {
            if (!tempRecords[playerId]) {
                tempRecords[playerId] = { matches: 0, goals: 0, assists: 0, mom: 0 };
            }
            if (tempRecords[playerId][statType] > 0) {
                tempRecords[playerId][statType]--;
            }
            updateStatDisplay(playerId, statType);
        }

        // Ïä§ÌÉØ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateStatDisplay(playerId, statType) {
            const value = tempRecords[playerId][statType];
            document.getElementById(`value-${statType}-${playerId}`).textContent = value;
        }

        // MOM ÌÜ†Í∏Ä (Îçî Ïù¥ÏÉÅ ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÏßÄÎßå Ìò∏ÌôòÏÑ±ÏùÑ ÏúÑÌï¥ Ïú†ÏßÄ)
        function toggleMOM(playerId) {
            if (!tempRecords[playerId]) {
                tempRecords[playerId] = { matches: 0, goals: 0, assists: 0, mom: 0 };
            }
            const checkbox = document.getElementById(`mom-${playerId}`);
            tempRecords[playerId].mom = checkbox.checked ? 1 : 0;
            document.getElementById(`value-mom-${playerId}`).textContent = tempRecords[playerId].mom;
        }

        // Ìé∏Ïßë Î™®Îìú ÌÜ†Í∏Ä
        function toggleEditMode() {
            if (!currentSeasonId) {
                alert('ÏãúÏ¶åÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            isEditMode = !isEditMode;
            const editBtn = document.getElementById('editBtn');
            const footerButtons = document.getElementById('footerButtons');
            const statItems = document.querySelectorAll('.stat-item');

            if (isEditMode) {
                editBtn.textContent = 'Ìé∏Ïßë Ï§ë...';
                editBtn.style.background = '#ccc';
                editBtn.style.color = '#999';
                editBtn.style.cursor = 'not-allowed';
                footerButtons.style.display = 'flex';
                statItems.forEach(item => item.classList.add('edit-mode'));
            } else {
                editBtn.textContent = 'ÏàòÏ†ï';
                editBtn.style.background = 'var(--field-green)';
                editBtn.style.color = 'white';
                editBtn.style.cursor = 'pointer';
                footerButtons.style.display = 'none';
                statItems.forEach(item => item.classList.remove('edit-mode'));
            }
        }

        // Í∏∞Î°ù Ï†ÄÏû•
        function saveRecords() {
            const season = seasons.find(s => s.id === currentSeasonId);
            if (season) {
                season.records = JSON.parse(JSON.stringify(tempRecords));
                localStorage.setItem('allSeasons', JSON.stringify(seasons));

                const message = document.getElementById('successMessage');
                message.style.display = 'block';

                setTimeout(() => {
                    message.style.display = 'none';
                }, 2000);

                toggleEditMode();
            }
        }

        // Ìé∏Ïßë Ï∑®ÏÜå
        function cancelEdit() {
            const season = seasons.find(s => s.id === currentSeasonId);
            if (season) {
                tempRecords = JSON.parse(JSON.stringify(season.records));
                renderPlayerRecords();
            }
            toggleEditMode();
        }

        // Îí§Î°úÍ∞ÄÍ∏∞
        function goBack() {
            window.location.href = 'index.html';
        }

        // === Í≤ΩÍ∏∞ Ï†ÑÏ†Å Í¥ÄÎ†® Ìï®Ïàò ===

        // Í≤ΩÍ∏∞ Ï∂îÍ∞Ä Î™®Îã¨ Ïó¥Í∏∞
        function openMatchModal() {
            if (!currentSeasonId) {
                alert('ÏãúÏ¶åÏùÑ Î®ºÏ†Ä ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            myScore = 0;
            opponentScore = 0;
            document.getElementById('myScore').textContent = '0';
            document.getElementById('opponentScore').textContent = '0';
            document.getElementById('matchDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('opponentName').value = '';
            document.getElementById('matchModal').style.display = 'block';
        }

        // Í≤ΩÍ∏∞ Ï∂îÍ∞Ä Î™®Îã¨ Îã´Í∏∞
        function closeMatchModal() {
            document.getElementById('matchModal').style.display = 'none';
        }

        // Ï†êÏàò Ï°∞Ï†ï
        function adjustScore(team, delta) {
            if (team === 'my') {
                myScore = Math.max(0, myScore + delta);
                document.getElementById('myScore').textContent = myScore;
            } else {
                opponentScore = Math.max(0, opponentScore + delta);
                document.getElementById('opponentScore').textContent = opponentScore;
            }
        }

        // Í≤ΩÍ∏∞ Ï†ÄÏû•
        function saveMatch() {
            const matchDate = document.getElementById('matchDate').value;
            const opponentName = document.getElementById('opponentName').value.trim();

            if (!matchDate) {
                alert('Í≤ΩÍ∏∞ ÎÇ†ÏßúÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            if (!opponentName) {
                alert('ÏÉÅÎåÄ ÌåÄ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            const season = seasons.find(s => s.id === currentSeasonId);
            if (!season) return;

            if (!season.matches) {
                season.matches = [];
            }

            const match = {
                id: Date.now().toString(),
                date: matchDate,
                opponent: opponentName,
                myScore: myScore,
                opponentScore: opponentScore,
                result: myScore > opponentScore ? 'win' : myScore < opponentScore ? 'loss' : 'draw'
            };

            season.matches.push(match);
            localStorage.setItem('allSeasons', JSON.stringify(seasons));

            closeMatchModal();
            renderMatchRecords();

            const message = document.getElementById('successMessage');
            message.textContent = 'Í≤ΩÍ∏∞Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§! ';
            message.style.display = 'block';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        // Í≤ΩÍ∏∞ Ï†ÑÏ†Å Î†åÎçîÎßÅ
        function renderMatchRecords() {
            const matchRecordsSection = document.getElementById('matchRecordsSection');
            const matchList = document.getElementById('matchList');
            const showMoreBtn = document.getElementById('showMoreBtn');

            if (!currentSeasonId) {
                matchList.innerHTML = '<p style="text-align: center; padding: 40px 20px; color: #999;">ÏãúÏ¶åÏùÑ ÏÑ†ÌÉùÌïòÎ©¥ Í≤ΩÍ∏∞ Ï†ÑÏ†ÅÏùÑ Í¥ÄÎ¶¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.</p>';
                showMoreBtn.style.display = 'none';
                return;
            }

            const season = seasons.find(s => s.id === currentSeasonId);
            if (!season || !season.matches || season.matches.length === 0) {
                matchList.innerHTML = '<p style="text-align: center; padding: 40px 20px; color: #999;">ÏïÑÏßÅ Îì±Î°ùÎêú Í≤ΩÍ∏∞Í∞Ä ÏóÜÏäµÎãàÎã§.<br>"+ Í≤ΩÍ∏∞ Ï∂îÍ∞Ä" Î≤ÑÌäºÏùÑ ÎàåÎü¨ Í≤ΩÍ∏∞Î•º Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî.</p>';
                showMoreBtn.style.display = 'none';
                return;
            }

            // ÌåÄ Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
            const teamInfo = localStorage.getItem('teamInfo');
            let teamLogo = '';
            let teamName = currentTeam ? currentTeam.teamName : 'Ïö∞Î¶¨ ÌåÄ';

            if (teamInfo) {
                const info = JSON.parse(teamInfo);
                if (info.logo) {
                    teamLogo = `<img src="${info.logo}" alt="ÌåÄ Î°úÍ≥†" class="match-team-logo">`;
                }
                if (info.teamName) {
                    teamName = info.teamName;
                }
            }

            // ÏµúÏã†Ïàú Ï†ïÎ†¨
            const sortedMatches = [...season.matches].sort((a, b) => new Date(b.date) - new Date(a.date));

            // ÌëúÏãúÌï† Í≤ΩÍ∏∞ Ïàò Í≤∞Ï†ï
            const displayMatches = showAllMatches ? sortedMatches : sortedMatches.slice(0, 5);

            let html = '';
            displayMatches.forEach(match => {
                const date = new Date(match.date);
                const matchDate = date.toLocaleDateString('ko-KR', {
                    month: 'short',
                    day: 'numeric',
                    weekday: 'short'
                });

                html += `
                    <div class="match-item ${match.result}">
                        ${teamLogo}
                        <div class="match-team-name">${teamName}</div>
                        <div class="match-score">${match.myScore} : ${match.opponentScore}</div>
                        <div class="match-opponent">${match.opponent}</div>
                        <div class="match-date">${matchDate}</div>
                    </div>
                `;
            });

            matchList.innerHTML = html;

            // ÎçîÎ≥¥Í∏∞ Î≤ÑÌäº ÌëúÏãú Ïó¨Î∂Ä
            if (sortedMatches.length > 5) {
                showMoreBtn.style.display = 'block';
                showMoreBtn.textContent = showAllMatches ? 'Ï†ëÍ∏∞' : `ÎçîÎ≥¥Í∏∞ (${sortedMatches.length - 5}Í∞ú Îçî)`;
            } else {
                showMoreBtn.style.display = 'none';
            }
        }

        // ÎçîÎ≥¥Í∏∞/Ï†ëÍ∏∞ ÌÜ†Í∏Ä
        function toggleShowMore() {
            showAllMatches = !showAllMatches;
            renderMatchRecords();
        }

        // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
        window.onclick = function(event) {
            const matchModal = document.getElementById('matchModal');
            if (event.target === matchModal) {
                closeMatchModal();
            }
        };
    </script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="auth.js"></script>
</body>
</html>